:root{
  --bg:#0b1020;
  --card:#131a2a;
  --muted:#8aa0b3;
  --text:#e6eef6;
  --acc:#5b9cff;
  --accent-2:#05d68f;
  --warn:#ffcc00;
  --danger:#ff6b6b;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font:14px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--text);
  background:radial-gradient(1200px 800px at 70% -10%, #12213f, #0b1020 60%);
}
header{
  position:relative; padding:24px 20px 8px;
}
header h1{margin:0 0 8px;font-weight:700;letter-spacing:.3px}
header p{margin:0;color:var(--muted)}
main{
  display:grid;gap:20px;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  padding:12px 20px 32px;max-width:1200px;margin:0 auto;
}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  padding:16px;
  box-shadow:0 8px 30px rgba(0,0,0,.25);
}
.card h2{margin:0 0 12px;font-size:18px}
.row{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin:10px 0}
label{display:flex;flex-direction:column;gap:6px}
input[type="file"]{padding:8px 0}
input,select,textarea,button{
  background:#0e1626;color:var(--text);border:1px solid rgba(255,255,255,.12);
  border-radius:10px;padding:10px 12px;outline:none
}
input:focus,select:focus,textarea:focus,button:focus{border-color:var(--acc);box-shadow:0 0 0 3px rgba(91,156,255,.15)}
.checkbox{flex-direction:row;align-items:center;gap:8px}
.actions{gap:8px}
button{
  cursor:pointer;border:1px solid rgba(255,255,255,.16);background:linear-gradient(180deg,#1a2740,#121b2f);
}
button:hover{border-color:var(--acc)}
button:disabled{opacity:.5;cursor:not-allowed}
textarea{
  width:100%;min-height:160px;resize:vertical;font-family:ui-monospace,SFMono-Regular,Consolas,monospace;
}
.meta{color:var(--muted);display:grid;gap:6px}
.warning{color:var(--warn)}
.hidden{display:none !important}
.file-input input{max-width:300px}
#dec-input{min-height:220px}
footer{padding:8px 20px 20px;color:var(--muted)}

/* QR Code Modal Styles */
.qr-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.qr-modal-content {
  background: var(--card);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 14px;
  padding: 20px;
  max-width: 400px;
  width: 90%;
  text-align: center;
  position: relative;
}

.qr-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.qr-modal-header h3 {
  margin: 0;
  color: var(--text);
  font-size: 18px;
}

.qr-close {
  background: transparent;
  border: 1px solid rgba(255,255,255,.2);
  color: var(--text);
  font-size: 20px;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.qr-close:hover {
  border-color: var(--acc);
  background: rgba(255,255,255,.1);
}

.qr-refresh {
  background: var(--acc);
  border: 1px solid var(--acc);
  color: white;
  padding: 5px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s;
}

.qr-refresh:hover {
  background: transparent;
  color: var(--acc);
}

.qr-display {
  margin: 20px 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 200px;
  background: white;
  border-radius: 8px;
  padding: 10px;
}

.qr-video {
  width: 100%;
  max-width: 300px;
  height: auto;
  border-radius: 8px;
  background: #000;
}

.qr-hint {
  color: var(--muted);
  font-size: 14px;
  margin: 10px 0;
}

/* Light theme QR styles */
body[data-theme="light"] .qr-modal-content {
  background: var(--card);
  border-color: rgba(0,0,0,.08);
}

body[data-theme="light"] .qr-close {
  border-color: rgba(0,0,0,.2);
}

body[data-theme="light"] .qr-close:hover {
  border-color: var(--acc);
  background: rgba(0,0,0,.1);
}

/* Theme toggle button */
#theme-toggle{
  position:absolute; right:16px; top:16px;
  width:36px; height:36px; padding:0; margin:0;
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:50%;
  background:transparent; border:1px solid rgba(255,255,255,.18);
  color:var(--text);
}
#theme-toggle:hover{border-color:var(--acc); background:rgba(255,255,255,.06)}
#theme-toggle .icon{display:block}
#theme-toggle .sun{display:none}
#theme-toggle .moon{display:block}

/* In light mode, show sun (meaning you can switch to dark) */
body[data-theme="light"] #theme-toggle{border-color:rgba(0,0,0,.15)}
body[data-theme="light"] #theme-toggle:hover{background:rgba(0,0,0,.05)}
body[data-theme="light"] #theme-toggle .sun{display:block}
body[data-theme="light"] #theme-toggle .moon{display:none}

/* Light theme variables override */
body[data-theme="light"]{
  --bg:#f6f8fb;
  --card:#ffffff;
  --muted:#556270;
  --text:#0e1626;
  --acc:#2263e5;
  --accent-2:#0aa66f;
  --warn:#a86b00;
  --danger:#c0392b;
  background:#f2f5fa;
}

body[data-theme="light"] header p{color:var(--muted)}
body[data-theme="light"] .card{background:linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,.01)); border-color:rgba(0,0,0,.08); box-shadow:0 8px 24px rgba(0,0,0,.08)}
body[data-theme="light"] input, body[data-theme="light"] select, body[data-theme="light"] textarea, body[data-theme="light"] button{background:#f7f9fc; color:var(--text); border-color:rgba(0,0,0,.12)}
body[data-theme="light"] button{background:linear-gradient(180deg,#f7f9fc,#e9eef6)}

/* Responsive enhancements for mobile */
@media (max-width: 640px) {
  header{padding:16px 12px 6px}
  #theme-toggle{right:10px; top:10px; width:34px; height:34px}
  header h1{font-size:22px}
  header p{font-size:14px}

  main{padding:8px 12px 20px;grid-template-columns:1fr;gap:14px}
  .card{padding:12px;border-radius:12px}

  .row{flex-direction:column;align-items:stretch}
  label{width:100%}
  .file-input input{max-width:none;width:100%}

  /* Make actions comfortable on touch screens */
  .actions{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .actions button{width:100%}
  /* Let the last button stretch full width if odd count */
  .actions button:last-child:nth-child(odd){grid-column:1 / -1}

  /* Avoid iOS input zoom by ensuring 16px font-size */
  input,select,textarea,button{font-size:16px}

  textarea{min-height:140px}
  #dec-input{min-height:180px}

  footer{padding:8px 12px calc(20px + env(safe-area-inset-bottom))}
  .row select#enc-compress-method, .row select#enc-compress-level{min-width:auto;width:100%}
  
  /* QR modal responsive */
  .qr-modal-content {
    max-width: 95%;
    padding: 15px;
  }
  
  .qr-video {
    max-width: 280px;
  }
}

.row select#enc-compress-method, .row select#enc-compress-level{min-width:140px}

@media (max-width: 380px) {
  header h1{font-size:20px}
  .actions{grid-template-columns:1fr}
}
